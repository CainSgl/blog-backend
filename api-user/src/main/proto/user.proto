syntax = "proto3";
package com.cainsgl.grpc;
option java_package = "com.cainsgl.grpc.user";
option java_outer_classname = "UserServiceProto";
option java_multiple_files = true;

message ProcessLogRequest {
    int32 value = 1;
}

message ProcessLogResponse {
    string result = 1;
}

// UserLog Service
service UserLogService {
    rpc loadLogsToRedis (ProcessLogRequest) returns (ProcessLogResponse);
}
// UserExtraInfo Service
//获取用户兴趣向量的
message GetInterestVectorRequest {
    int64 user_id = 1;
}

message GetInterestVectorResponse {
    repeated float interest_vector = 1;
}
//设置用户兴趣向量
message SetInterestVectorRequest {
    int64 user_id = 1;
    repeated float interest_vector = 2;
}

message SetInterestVectorResponse {
    bool success=1;
}


// User Service
message MallocMemoryRequest {
    int64 user_id = 1;
    int32 memory = 2;
}

message MallocMemoryResponse {
    bool success = 1;
}

service UserService {
    rpc mallocMemory (MallocMemoryRequest) returns (MallocMemoryResponse);
}

// SaveCount Service
message SaveCountRequest {
    int64 user_id = 1;
    optional int32 like_count = 2;
    optional int32 comment_count = 3;
    optional int32 post_count = 4;
    optional int32 article_view_count = 5;
    optional int32 following_count = 6;
    optional int32 follower_count = 7;
}

message BatchSaveCountRequest {
    repeated SaveCountRequest requests = 1;
}

message SaveCountResponse {
    bool success = 1;
}

service UserExtraInfoService {
    rpc getInterestVector (GetInterestVectorRequest) returns (GetInterestVectorResponse);
    rpc setInterestVector (SetInterestVectorRequest) returns (SetInterestVectorResponse);
    rpc saveCount (BatchSaveCountRequest) returns (SaveCountResponse);
}

// UserFollow Service
message HasFollowRequest {
    int64 follower_id = 1;
    int64 followee_id = 2;
}

message HasFollowResponse {
    bool has_follow = 1;
}

service UserFollowService {
    rpc hasFollow (HasFollowRequest) returns (HasFollowResponse);
}
